# ComfyUI Batch Configuration - Type 1: Base Model (No LoRA) Sampler Test
# For workflows WITHOUT Light LoRAs - using 20-30 steps for full quality
#
# NOTE: This config assumes you've REMOVED the LoRA nodes (91, 92) from workflow
#       or disabled them. Light LoRAs don't work well with high step counts!

workflow_file: ../workflow.json
sampling_strategy: grid
num_samples: 100  # Ignored for grid
seeds_per_sample: 2  # 2 seeds per combo

parameters:
  # Test 5 samplers with 3 schedulers = 5 × 3 × 2 = 30 videos
  # These samplers work well with higher step counts

  sampler_name:
    path: nodes.57.inputs.sampler_name
    type: values
    values:
      - "euler"           # Reliable baseline
      - "dpmpp_2m"        # Popular for quality
      - "dpmpp_2m_sde"    # SDE variant, excellent detail
      - "heun"            # High quality, needs more steps
      - "uni_pc"          # Fast convergence

  scheduler:
    path: nodes.57.inputs.scheduler
    type: values
    values:
      - "normal"          # Standard
      - "karras"          # Often best for quality
      - "exponential"     # Good detail preservation

  # Mirror for node 58
  sampler_name_node58:
    path: nodes.58.inputs.sampler_name
    type: values
    values: ["euler", "dpmpp_2m", "dpmpp_2m_sde", "heun", "uni_pc"]

  scheduler_node58:
    path: nodes.58.inputs.scheduler
    type: values
    values: ["normal", "karras", "exponential"]

  # ============================================================================
  # BASE MODEL STEP COUNTS (15-30 steps)
  # ============================================================================

  sampling_shift:
    path: nodes.54.inputs.shift
    type: values
    values: [5]

  sampling_shift_node55:
    path: nodes.55.inputs.shift
    type: values
    values: [5]

  # Higher step counts for base model quality
  sampler_steps:
    path: nodes.57.inputs.steps
    type: values
    values: [20]  # Can try [15, 20, 25, 30] to explore

  sampler_steps_node58:
    path: nodes.58.inputs.steps
    type: values
    values: [20]

  # CFG can be higher with more steps
  sampler_cfg:
    path: nodes.57.inputs.cfg
    type: values
    values: [1.5]  # Can explore [1.0, 1.5, 2.0]

  sampler_cfg_node58:
    path: nodes.58.inputs.cfg
    type: values
    values: [1.5]

  # Step ranges (may need adjustment for base model)
  sampler_start_at_step:
    path: nodes.57.inputs.start_at_step
    type: values
    values: [0]

  sampler_end_at_step:
    path: nodes.57.inputs.end_at_step
    type: values
    values: [10]  # Adjust based on total steps

  sampler_start_at_step_node58:
    path: nodes.58.inputs.start_at_step
    type: values
    values: [10]

  sampler_end_at_step_node58:
    path: nodes.58.inputs.end_at_step
    type: values
    values: [10000]

  # Video settings
  video_fps:
    path: nodes.60.inputs.fps
    type: values
    values: [24]

  wanfirstlastframetovideo_width:
    path: nodes.67.inputs.width
    type: values
    values: [1280]

  wanfirstlastframetovideo_height:
    path: nodes.67.inputs.height
    type: values
    values: [720]

  wanfirstlastframetovideo_length:
    path: nodes.67.inputs.length
    type: values
    values: [121]

  wanfirstlastframetovideo_batch_size:
    path: nodes.67.inputs.batch_size
    type: values
    values: [1]

  # NOTE: Remove or set to 0 if no LoRAs in workflow!
  # These will be ignored if LoRA nodes are removed
  lora_strength_model:
    path: nodes.91.inputs.strength_model
    type: values
    values: [0.0]  # Disabled

  lora_strength_model_node92:
    path: nodes.92.inputs.strength_model
    type: values
    values: [0.0]  # Disabled

  # Random seeds
  sampler_noise_seed:
    path: nodes.57.inputs.noise_seed
    type: random_seed

  sampler_noise_seed_node58:
    path: nodes.58.inputs.noise_seed
    type: random_seed

output:
  base_dir: output
  run_name_pattern: '{run_id:04d}_s{sampler_name}_sch{scheduler}_st{sampler_steps}'
  save_params_json: true
  save_metadata_csv: true

resume:
  enabled: true
  skip_existing: true

comfyui:
  server_address: 127.0.0.1:8188
  poll_interval: 2

# ============================================================================
# USAGE NOTES FOR TYPE 1 (BASE MODEL)
# ============================================================================
#
# 1. MUCH SLOWER than Light LoRA workflows
#    - Each video takes 5-10x longer to generate
#    - 20 steps vs 4 steps = significant time difference
#
# 2. HIGHEST QUALITY OUTPUT
#    - Maximum detail and temporal coherence
#    - Best for final production renders
#
# 3. VRAM REQUIREMENTS
#    - May need to reduce batch_size or resolution for limited VRAM
#
# 4. STEP COUNT EXPLORATION
#    - Try 15, 20, 25, 30 steps
#    - Diminishing returns after ~25 steps for most models
#    - More steps = better quality but much slower
#
# 5. CFG EXPLORATION
#    - Base models work well with CFG 1.0-2.0
#    - Higher CFG = stronger prompt adherence
#    - Too high CFG = oversaturated, artifacts
#
# ============================================================================
